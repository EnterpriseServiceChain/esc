<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>esc: Enterprise Service Chain</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">esc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_sraczynski_DEV_biogit_hpx_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Enterprise Service Chain </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Enterprise Service Chain (ESC) is a block chain based software tool facilitating high volumes of simple transactions that, in most cases, send tokens between accounts as in other crypto currencies. The name is derived from the concept of the Enterprise Service Bus in which a crypto currency is used as the protocol of communication.</p>
<p>The main features of the Enterprise Service Chain can be summarized as follows:</p><ul>
<li>Delegated Proof of Stake as block consensus mechanism to reduce network maintenance costs</li>
<li>Small account and transaction identifiers, reduced transaction set and parallel processing of transactions to facilitate high transaction volumes (&gt;100kHz one-one transactions, &gt;1MHz one-many transactions)</li>
<li>Nodes are heavily penalized for double spends so most transactions can be trusted almost instantly</li>
<li>Small set of VIP nodes responsible for network integrity to facilitate incorporation of slow nodes with reduced transaction processing capabilities</li>
<li>Hash of all accounts is part of the block and enables instant synchronization with the block chain</li>
<li>Hierarchical organization of accounts and nodes facilitates KYC, AML , eID supply and governance</li>
<li>Dividend payments to account holders and node managers to support the growth of the economy of the ESC system</li>
</ul>
<h2>Details</h2>
<p>A <a href="docs/ESC.pdf">white paper</a> provides a more detailed description of the concept of the Enterprise Service Chain.</p>
<h2>Current status</h2>
<p>The software is currently an academic proof of concept. It does not have a user-friendly class structure. It lacks comments. It has small bugs. It has a long ToDo list, but it can be deployed and tested. An instruction for the deployment will be provided shortly.</p>
<h2>Installation</h2>
<p>The software is developed for Linux platform. There is no intent to support other platforms. The software was tested on Debian and Ubuntu. To compile the software You need boost and ssl libraries. Check the Makefile if anything else is missing.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install openssl libboost-all-dev libssl-dev</div></div><!-- fragment --><p>Start with cloning the git directory.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone https://github.com/adshares/esc.git</div></div><!-- fragment --><p>Before compiling ESC You could check if the ed25519 cryptography software is working correctly and what compile option gives You better speed for Your CPU.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd esc/ed25519</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;make -f Makefile.sse2</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;./mytest</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;make clean</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;make</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;./mytest</div></div><!-- fragment --><p>I our case compiling for sse2 reduces the speed of batch signature verifications by over 30% (it is not the case on AWS). The results of the 2 runs are shown below. The line stating with "BATC" reports number of signature verifications per second. Compiling against the regular Makefile (<code>make</code>) generates a code that can perform over 30k signature verifications per second.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;START</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;HASH: 1295553.388/s [79.074MiB/s]</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;PKEY: 29027.926/s</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;SIGN: 28596.429/s [1.745MiB/s]</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;OPEN: 8721.537/s [0.532MiB/s]</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;BATC: 18608.159/s [1.136MiB/s]</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;START</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;HASH: 836288.155/s [51.043MiB/s]</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;PKEY: 48491.258/s</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;SIGN: 47754.419/s [2.915MiB/s]</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;OPEN: 14017.216/s [0.856MiB/s]</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;BATC: 30312.243/s [1.850MiB/s]</div></div><!-- fragment --><p>Keep the compiled object files in the directory and compile ESC.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd ..</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;make</div></div><!-- fragment --><p>The default Makefile contains the DEBUG option. If You want to run production speed tests, then compile against Makefile.ndebug. The compilation should finish in few seconds.</p>
<p>When compiling, the compiler will detect if You have a recent kernel that supports the "FALLOC_FL_COLLAPSE_RANGE" option for fallocate(). This option is used to remove old (first) pages from log files and works only on ext4 file systems. If You don't have a recent kernel or run the software on a different file system, then user log files will not be purged (will grow forever). We will consider adding support for this case in the future.</p>
<h2>Setting up a local test net</h2>
<p>Create a directory for Your first node and the first user and create links to executables for convenience.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir /tmp/node1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;ln -s $PWD/escd /tmp/node1/escd</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;mkdir /tmp/user0</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;ln -s $PWD/esc /tmp/user0/esc</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;ln -s $PWD/ed25519/key  /tmp/user0/key</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;cd /tmp/node1/</div></div><!-- fragment --><p>To start the first node enter</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir ../node1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd ../node1</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;echo &#39;svid=1&#39; &gt; options.cfg</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;echo &#39;offi=9091&#39; &gt;&gt; options.cfg</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;echo &#39;port=8091&#39; &gt;&gt; options.cfg</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;./escd --init 1</div></div><!-- fragment --><p>The program will detect that it is in an empty directory and will create an initial setup with a single node and an administrator account for the node. The current version is compiled with temporary development setting with a much shorter block period (32s, defined in <a class="el" href="default_8hpp_source.html">default.hpp</a>). Keep the node running for at least 1 block period to initialize the block-chain correctly. You can stop a node by typing a dot (".") followed by enter. Currently, killing the node with a signal (^C) may destroy the database files. You can continue with the same block-chain by running the code again with the '&ndash;init 1' switch.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./escd --init 1</div></div><!-- fragment --><p>The first node will start with the default node secret key stored in key/key.txt . The secret key to the admin account is the same. Secret keys can be created by running the key executable with a selected brain-key-string (ed25519/key "brain-key-string"). Both keys can be changed later. In production the node key and the admin key should differ for security reasons. To add more nodes and users open a new terminal and connect to the running node as admin (user with account number 0). We have created a directory for the user previously. Let's go there.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd /tmp/user0</div></div><!-- fragment --><p>Let's create the file containing the connection setting for the user.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;echo &#39;port=9091&#39; &gt; settings.cfg</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;echo &#39;host=127.0.0.1&#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;echo &#39;address=0001-00000000-XXXX&#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;echo &#39;secret=14B183205CA661F589AD83809952A692DFA48F5D490B10FD120DA7BF10F2F4A0&#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;chmod go-r settings.cfg</div></div><!-- fragment --><p>This is the account address of our user 0001-00000000-XXXX. Last 4 characters should be hex characters defining the checksum. If 'XXXX' is provided the checksum is not tested. Let's try to connect to the node and get the current status of our user.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39; | ./esc 2&gt;err.txt</div></div><!-- fragment --><p>This command should list the current status of the user. We should get something like this:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    &quot;tx&quot;: {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        &quot;data&quot;: &quot;1001000000000001000000000045975E5960A14655AC8341861CECEAB040054058CC3EF62708565B75C4173FB80D60BD74D7DFCFE3EC3C441A95B48D703E6578BFBC161AF3CC1A0F118B32D278336C5704&quot;,</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        &quot;account_msid&quot;: &quot;0&quot;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    },</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    &quot;account&quot;: {</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        &quot;address&quot;: &quot;0001-00000000-9B6F&quot;,</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        &quot;node&quot;: &quot;1&quot;,</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        &quot;id&quot;: &quot;0&quot;,</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        &quot;msid&quot;: &quot;1&quot;,</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        &quot;time&quot;: &quot;1499368832&quot;,</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        &quot;date&quot;: &quot;2017-07-06 21:20:32&quot;,</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        &quot;status&quot;: &quot;0&quot;,</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        &quot;paired_node&quot;: &quot;1&quot;,</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        &quot;paired_id&quot;: &quot;0&quot;,</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        &quot;local_change&quot;: &quot;1499368832&quot;,</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        &quot;remote_change&quot;: &quot;1499371296&quot;,</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        &quot;balance&quot;: &quot;4611617760.726175776&quot;,</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        &quot;public_key&quot;: &quot;7D21F4EE7DE72EEDDC2EBFFEC5E7F33F140A975A629EE312075BB04610A9CFFF&quot;,</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        &quot;hash&quot;: &quot;000000000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    },</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    &quot;network_account&quot;: {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        &quot;address&quot;: &quot;0001-00000000-9B6F&quot;,</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        &quot;node&quot;: &quot;1&quot;,</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        &quot;id&quot;: &quot;0&quot;,</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        &quot;msid&quot;: &quot;1&quot;,</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        &quot;time&quot;: &quot;1499368832&quot;,</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        &quot;date&quot;: &quot;2017-07-06 21:20:32&quot;,</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        &quot;status&quot;: &quot;0&quot;,</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        &quot;paired_node&quot;: &quot;1&quot;,</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        &quot;paired_id&quot;: &quot;0&quot;,</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        &quot;local_change&quot;: &quot;1499368832&quot;,</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        &quot;remote_change&quot;: &quot;1499371296&quot;,</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        &quot;balance&quot;: &quot;4611617760.726175776&quot;,</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        &quot;public_key&quot;: &quot;7D21F4EE7DE72EEDDC2EBFFEC5E7F33F140A975A629EE312075BB04610A9CFFF&quot;,</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        &quot;hash&quot;: &quot;000000000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF&quot;,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        &quot;checksum&quot;: &quot;true&quot;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    }</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div></div><!-- fragment --><p>No standard output means the connection failed. You can try to examine err.txt for some clues. Correct standard output show the correct account number for the admin of the first node, which is "0001-00000000-9B6F" (the checksum is 9B6F). Now let's change our secret key and create a new account with a new key. First let's generate 2 keys.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./key &quot;user-0-0&quot;</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;SK: FF767FC8FAF9CFA8D2C3BD193663E8B8CAC85005AD56E085FAB179B52BD88DD6</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;PK: D69BCCF69C2D0F6CED025A05FA7F3BA687D1603AC1C8D9752209AC2BBF2C4D17</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;SG: 7A1CA8AF3246222C2E06D2ADE525A693FD81A2683B8A8788C32B7763DF6037A5DF3105B92FEF398AF1CDE0B92F18FE68DEF301E4BF7DB0ABC0AEA6BE24969006</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./key &quot;user-0-1&quot;</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;SK: 5BF11F5D0130EC994F04B6C5321566A853B7393C33F12E162A6D765ADCCCB45C</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;PK: C9965A1417F52B22514559B7608E4E2C1238FCA3602382C535D42D1759A2F196</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;SG: ED8479C0EDA3BB02B5B355E05F66F8161811F5AD9AE9473AA91E2DA32457EAB850BC6A04D6D4D5DDFAB4B192D2516D266A38CEA4251B16ABA1DF1B91558A4A05</div></div><!-- fragment --><p>The secret keys are printed in the lines starting with "SK:". The line starting with "SG:" contains the signature of an empty phrase signed with the secret key. This signature is uses as checksum when creating a new account. Let's change the key for the admin account now:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;(echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39;; echo &#39;{&quot;run&quot;:&quot;change_account_key&quot;,&quot;pkey&quot;:&quot;D69BCCF69C2D0F6CED025A05FA7F3BA687D1603AC1C8D9752209AC2BBF2C4D17&quot;,&quot;signature&quot;:&quot;7A1CA8AF3246222C2E06D2ADE525A693FD81A2683B8A8788C32B7763DF6037A5DF3105B92FEF398AF1CDE0B92F18FE68DEF301E4BF7DB0ABC0AEA6BE24969006&quot;}&#39;) | ./esc</div></div><!-- fragment --><p>After this the admin needs a new secret key to connect to its account, so let's fix the settings.txt file.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;echo &#39;port=9091&#39; &gt; settings.cfg</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;echo &#39;host=127.0.0.1&#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;echo &#39;address=0001-00000000-9B6F&#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;echo &#39;secret= FF767FC8FAF9CFA8D2C3BD193663E8B8CAC85005AD56E085FAB179B52BD88DD6&#39; &gt;&gt; settings.cfg</div></div><!-- fragment --><p>And confirm that we can connect again with the new key.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39; | ./esc 2&gt;err.txt</div></div><!-- fragment --><p>The output should indicate that our transaction id was incremented and is now equal 2 ("msid": "2",). Let's now create the second user.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;(echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39;; echo &#39;{&quot;run&quot;:&quot;create_account&quot;,&quot;node&quot;:&quot;0001&quot;}&#39;) | ./esc</div></div><!-- fragment --><p>The new user is managed by our node so the creation process will be fast and the node will report the new account number for the local user in the paired_id field ("paired_id": "1"). Let's read the status of the new user account.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;echo &#39;{&quot;run&quot;:&quot;get_account&quot;,&quot;address&quot;:&quot;0001-00000001-XXXX&quot;}&#39; | ./esc</div></div><!-- fragment --><p>We should see that the correct new account address is "0001-00000001-8B4E". The balance of the new user is too small to make any transactions so let's send him some funds.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;(echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39;; echo &#39;{&quot;run&quot;:&quot;send_one&quot;,&quot;address&quot;:&quot;0001-00000001-8B4E&quot;,&quot;amount&quot;:0.1,&quot;message&quot;:&quot;000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F&quot;}&#39;) | ./esc</div></div><!-- fragment --><p>The new balance shold be 0.362144000</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;echo &#39;{&quot;run&quot;:&quot;get_account&quot;,&quot;address&quot;:&quot;0001-00000001-8B4E&quot;}&#39; | ./esc 2&gt;/dev/null | grep balance</div></div><!-- fragment --><p>Let's change the public key of the new user by connecting as the new user with the current coppied key. Do not forget to use the "--address 0001-00000001-8B4E" here, otherwise You will change Your own public key. In normal cases You don't know the corresponding secret key so You will loose Your account.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;(echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39;; echo &#39;{&quot;run&quot;:&quot;change_account_key&quot;,&quot;pkey&quot;:&quot;C9965A1417F52B22514559B7608E4E2C1238FCA3602382C535D42D1759A2F196&quot;,&quot;signature&quot;:&quot;ED8479C0EDA3BB02B5B355E05F66F8161811F5AD9AE9473AA91E2DA32457EAB850BC6A04D6D4D5DDFAB4B192D2516D266A38CEA4251B16ABA1DF1B91558A4A05&quot;}&#39; )  | ./esc  --address 0001-00000001-8B4E</div></div><!-- fragment --><p>The output should indicate that the public key was changed. Let's connect as the new user after setting up the new environment.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir ../user1</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd ../user1</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;echo &#39;port=9091&#39; &gt; settings.cfg</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;echo &#39;host=127.0.0.1&#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;echo &#39;address=0001-00000001-8B4E &#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;echo &#39;secret= 5BF11F5D0130EC994F04B6C5321566A853B7393C33F12E162A6D765ADCCCB45C &#39; &gt;&gt; settings.cfg</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;chmod go-r settings.cfg</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39; | ../user0/esc</div></div><!-- fragment --><p>The output should indicate that You have successfully connected to the node as user "0001-00000001-8B4E". You don't have enough funds to create a new node. User0 will help You.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd ../user0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;(echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39;; echo &#39;{&quot;run&quot;:&quot;send_one&quot;,&quot;address&quot;:&quot;0001-00000001-8B4E&quot;,&quot;amount&quot;:70.0,&quot;message&quot;:&quot;000102030405060708090A0B0C0D0E0F101112131415161718191A1B1C1D1E1F&quot;}&#39;) | ./esc</div></div><!-- fragment --><p>Let's now try to create a new node. The new node will get the public key of the requesting user.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;(echo &#39;{&quot;run&quot;:&quot;get_me&quot;}&#39;; echo &#39;{&quot;run&quot;:&quot;create_node&quot;}&#39;) | ../user0/esc</div></div><!-- fragment --><p>It will take at least 1 block time for the network to create a new node. You can examine the log of the first node. Before block creation the node should show now info about 3 nodes (the first one is the unused node number 0). You should see lines like these</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;NOD: 00000000 00000000 ffff0000 00000000 595E8D80 0 0000000000000000 0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;NOD: eef4217d c08c88e1 8936fa16 0000003C 595EA5BB 6 3FFFC1DB71A5379A 2</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;NOD: 145a96c9 e186f4ad ffff0002 00000000 595EA5A0 0 0000000FFFF08000 1</div></div><!-- fragment --><p>When the new node is created You can send some funds to the new admin account (0002-00000000-XXXX) if You plan to perform any transaction. We will skip it because we will only try to connect a new node.</p>
<p>Let's create the directory and the files for the new node</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;mkdir ../node2</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd ../node2</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;echo &#39;svid=2&#39; &gt; options.cfg</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;echo &#39;offi=9092&#39; &gt;&gt; options.cfg</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;echo &#39;port=8092&#39; &gt;&gt; options.cfg</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;echo &#39;addr=127.0.0.1&#39; &gt;&gt; options.cfg</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;echo &#39;peer=127.0.0.1:8091&#39; &gt;&gt; options.cfg</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;mkdir key</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;chmod go-rx key/</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;echo &#39;5BF11F5D0130EC994F04B6C5321566A853B7393C33F12E162A6D765ADCCCB45C&#39; &gt; key/key.txt</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;chmod go-r key/key.txt</div></div><!-- fragment --><p>The configuration file (options.txt) indicates an initial peer address that we want to start syncing from. To connect to the network we also need a recent network topology file that already includes our new node. This file can be found in a recent block directory of the running node (and all nodes on the network). The blocks are in ../node1/blk/xxx/xxxxx. The block numbers correspond to unix time. Let's take a servers.txt file from ../node1/blk/595/EA9C0/ .</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cp ../node1/blk/595/EA9C0/servers.txt ./</div></div><!-- fragment --><p>Now we should be able to connect the new node to the network.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;../node1/escd -m 1 -f 1</div></div><!-- fragment --><p>The connection should be established shortly. You can stop the node again by pressing '.' and enter. The -m switch indicates that we need only 1 signature to trust the blocks (we have only 1 node). The -f switch indicates that we want to start from the current status of the block-chain. After stopping the second node, we should start it again without the -f option to load the missing blocks.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;../node1/escd -m 1</div></div><!-- fragment --><p>Connecting more nodes can be done iteratively . The nodes broadcast their IPs and ports on the network so there is no need to provide many peers in the options.cfg file.</p>
<p>Please remember that the current version is just a proof of concept. We will create a production version of the block-chain in the coming months. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
